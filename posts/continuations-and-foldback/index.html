<!doctype html>
<html lang="en-us">
    <head>
        <title>Continuations and foldBack // David Raab</title>
        <link rel="shortcut icon" href="/favicon.ico" />
        <meta charset="utf-8" />
        <meta name="generator" content="Hugo 0.109.0">
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="author" content="David Raab" />
        <meta name="description" content="This article shows how you can implement List.foldBack with a continuation function" />
        <link rel="stylesheet" href="/css/main.min.0fa334c3f2650e7000dfc8e81f59d23191e59e78f62c565a598f4dc557c92abe.css" />
        <script src="/static/code-toggle.js"></script>

        
        <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Continuations and foldBack"/>
<meta name="twitter:description" content="This article shows how you can implement List.foldBack with a continuation function"/>

        <meta property="og:title" content="Continuations and foldBack" />
<meta property="og:description" content="This article shows how you can implement List.foldBack with a continuation function" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://davidraab.github.io/posts/continuations-and-foldback/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2016-04-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2016-04-16T00:00:00+00:00" />


    </head>
    <body>
        <header class="app-header">
            <a href="https://davidraab.github.io"><img class="app-header-avatar" src="/avatar.jpg" alt="David Raab" /></a>
            <span class="app-header-title">David Raab</span>
            <nav class="app-header-menu">
                    <a class="app-header-menu-item" href="/">Home</a>
                         - 
                    
                    <a class="app-header-menu-item" href="/tags/">Tags</a>
            </nav>
            <p>My personal Blog. Writing about programming and other stuff.</p>
            <div class="app-header-social">
                
                    <a href="https://github.com/DavidRaab" target="_blank" rel="noreferrer noopener me">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>David Raab Github Profile</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
                    </a>
                
                    <a href="https://davidraab.github.io/index.xml" target="_blank" rel="noreferrer noopener me">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-rss">
  <title>Atom Feed</title>
  <path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle>
</svg>
                    </a>
                
            </div>
        </header>
        
<main class="app-container">
    <article class="post">
        <header class="post-header">
            <h1 class ="post-title">Continuations and foldBack</h1>
            <div class="post-meta">
                <div>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
                    Apr 16, 2016
                </div>
                <div>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
                    14 min read
                </div>
                <div>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
                            <a class="tag" href="https://davidraab.github.io/tags/fsharp/">FSharp</a>
                            <a class="tag" href="https://davidraab.github.io/tags/fold/">fold</a>
                            <a class="tag" href="https://davidraab.github.io/tags/list/">list</a>
                            <a class="tag" href="https://davidraab.github.io/tags/cps/">cps</a>
                            <a class="tag" href="https://davidraab.github.io/tags/recursion/">recursion</a>
                </div>
            </div>
        </header>
        <div class="post-content">
            <p>In <a href="https://davidraab.github.io/posts/loops-to-folds/">From mutable loops to immutable folds</a>
we implemented <code>foldBack</code> through <code>rev</code> and <code>fold</code>. In this post I show you how you can implement
<code>foldBack</code> by using a <em>continuation function</em>.</p>
<h1 id="functions">Functions</h1>
<p>Before we see how to implement <code>foldBack</code>, I want to give you analogy first. This analogy helped
me in a lot of cases. I hope that this analogy will also help you in better understanding
the further post, or probably even in other areas in programming in general.</p>
<h2 id="back-to-the-future">Back to the Future</h2>
<p>One idea how you can view functions is, that you can do stuff now, with things you not
have yet, but you know you will get them in the future. Sounds weird? Let&rsquo;s go over an
example that you probably already know. Function composition.</p>
<p>Usually most definitions of a function that does function composition have three arguments.
But let&rsquo;s write it with only two arguments. You are given the task to write a function
that has two functions as the input, and now you should compose them. How do you do that?</p>
<p>Usually you start with something like</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">compose</span> <span class="n">f</span> <span class="n">g</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>But what comes next? Your task is to execute <code>f</code> and pass the result to <code>g</code>. But how do you execute
<code>f</code> if you don&rsquo;t a value to execute <code>f</code>? The answer is, you create a function inside <code>compose</code>. This
function gets the value to execute <code>f</code> sometime in the future.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">compose</span> <span class="n">f</span> <span class="n">g</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="k">let</span> <span class="nv">innerFunction</span> <span class="n">x</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">        <span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="n">f</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>But what do you now do with <code>innerFunction</code>? We still don&rsquo;t have a value to execute <code>innerFunction</code>.
Yes, that&rsquo;s right, because of this, your only option is to return <code>innerFunction</code> from our <code>compose</code>
function.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">compose</span> <span class="n">f</span> <span class="n">g</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="k">let</span> <span class="nv">innerFunction</span> <span class="n">x</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">        <span class="k">let</span> <span class="nv">result</span> <span class="o">=</span> <span class="n">f</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">        <span class="n">g</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">    <span class="n">innerFunction</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This is exactly what <code>&gt;&gt;</code> does. It is only the fully expanded version of it. If you want to shorten it.
As you create a inner function and just return it. You also can just create a lambda directly and return
it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">compose</span> <span class="n">f</span> <span class="n">g</span> <span class="o">=</span> <span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">g</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>And because we have <em>Currying</em> and all functions are anyway just functions that returns function,
you just can add <code>x</code> as a function argument.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">compose</span> <span class="n">f</span> <span class="n">g</span> <span class="n">x</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="n">g</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It seems that i only explained <em>function composition</em> but the analogy I explained fits more nicely
into a lot more use-cases. It doesn&rsquo;t mean you only can execute some kind of functions with a value.
In general it means you already can work with a value you don&rsquo;t have yet! For example, you also
could write a function that first does something with <code>x</code> and then pass the result to it to <code>f</code>.</p>
<p>In general the analogy means. Whenever you need to somehow work with a value you don&rsquo;t have yet.
You just create a function. So you already can work with the value as if you had it. And you
can do whatever you want with it. But then instead of returning a result you return a function
instead. So you expect that someone else in the future gives you a value that starts your execution.</p>
<p>The general idea is. You already can compose behaviour or functions together without directly
executing anything. You first compose everything, and you delay the execution as far as possible
to the future.</p>
<h1 id="rethinking-the-problem">Rethinking the problem</h1>
<p>With that idea in-place. Let&rsquo;s look again at <code>foldBack</code> and if we somehow can rethink that
problem. Let&rsquo;s first focus on the behaviour of <code>foldBack</code> and how it should work <em>logically</em>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">f</span> <span class="n">x</span>     <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">squared</span> <span class="o">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">foldBack</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="n">acc</span> <span class="o">-&gt;</span> <span class="n">f</span> <span class="n">x</span> <span class="o">::</span> <span class="n">acc</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">]</span> <span class="bp">[]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The general <em>logic</em> is that we traverse a list backwards. Instead of starting with the initial
accumulator and fetching <code>1</code> from the last, we start by fetching <code>4</code> from the end. Then <code>3</code>, <code>2</code>
and last but not least <code>1</code>. The general logic how <code>foldBack</code> works is like that.</p>
<pre><code> list      | acc        | x | (f x) :: acc
-----------+------------+---+--------------
 [1;2;3;4] | []         | 4 | [16]
   [1;2;3] | [16]       | 3 | [9;16]
     [1;2] | [9;16]     | 2 | [4;9;16]
       [1] | [4;9;16]   | 1 | [1;4;9;16]
        [] | [1;4;9;16] | return -&gt; [1;4;9;16]
</code></pre>
<p>At this point let&rsquo;s focus on our <code>f</code> function that we pass <code>foldBack</code>. The <code>f</code> function
get the argument <code>x</code> and <code>acc</code>. What does those values represents at any point in time exactly?</p>
<p>As we basically just loop over a data-structure with <code>foldBack</code> it just means <code>x</code> is just
one element from our list. The interesting thing is what <code>acc</code> contains. <code>acc</code> contains
the <em>accumulation</em> of everything right from our current element. To be more concrete, let&rsquo;s
say we reached element <code>2</code>.</p>
<p>Then <code>x</code> contains <code>2</code>, but <code>acc</code> at this point in time contains <code>[9;16]</code>. It contains the result
of our accumulation that was right of <code>2</code>. Let&rsquo;s assume we have.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="nn">List</span><span class="p">.</span><span class="n">foldBack</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="n">acc</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">acc</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">]</span> <span class="mi">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In that case when we reach <code>2</code> our <code>x</code> is once again <code>2</code> but our <code>acc</code> contains <code>7</code>, because so
far it calculated <code>0 + 4 + 3</code>.</p>
<p>The only problem we have. We cannot go backwards through a list. That was the whole reason why we
reversed the list before we looped/recurs through it. We only can go from left to right.
And that is bad. Because we have to start with <code>1</code> and we need to pass an <code>acc</code> to the <code>f</code>
function that we don&rsquo;t have at that point in time!</p>
<p>Uhm wait! Isn&rsquo;t that exactly what we discussed previously? What do we do if we expect to work
with a value that we don&rsquo;t have yet? We create a function!</p>
<h1 id="functions-as-accumulator">Functions as accumulator</h1>
<p>The basic idea to solve our problem is by using a function that we use as our <em>accumulator</em>.
We use a function because we need to work with values we don&rsquo;t have yet. Because we have a
function I use <code>cont</code> (for Continuation) in our inner <code>loop</code> instead of <code>acc</code>. Let&rsquo;s
first write the basic template to loop through a list first.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">foldBack</span> <span class="n">f</span> <span class="kt">list</span> <span class="o">(</span><span class="n">acc</span><span class="o">:</span><span class="k">&#39;</span><span class="n">State</span><span class="o">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="k">let</span> <span class="nv">rec</span> <span class="n">loop</span> <span class="n">cont</span> <span class="kt">list</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">        <span class="k">match</span> <span class="kt">list</span> <span class="k">with</span>
</span></span><span class="line"><span class="cl">        <span class="o">|</span> <span class="bp">[]</span>      <span class="o">-&gt;</span> <span class="o">???</span>
</span></span><span class="line"><span class="cl">        <span class="o">|</span> <span class="n">x</span><span class="o">::</span><span class="kt">list</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="k">let</span> <span class="nv">newCont</span> <span class="o">=</span> <span class="o">???</span>
</span></span><span class="line"><span class="cl">            <span class="n">loop</span> <span class="n">newCont</span> <span class="kt">list</span>
</span></span><span class="line"><span class="cl">    <span class="n">loop</span> <span class="o">???</span> <span class="kt">list</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So the question we have are.</p>
<ol>
<li>What do we do for every element?</li>
<li>What do we do after we looped through our list?</li>
<li>With what kind of value do we start our loop?</li>
</ol>
<h2 id="what-do-we-do-for-every-element">What do we do for every element?</h2>
<p>At first, we reconsider what we are supposed to do. Our task is to execute the <em>folder</em>
function that the caller provided us as <code>f</code>. We pass this function the <em>current value</em> and the
<em>right-accumulator</em>. At this point in time we have the current value inside of <code>x</code>,
but we don&rsquo;t have the <em>right-accumulator</em>. What we now do, we just create a <em>inner function</em>
<code>newCont</code> that at some point in the future will get the <em>right-accumulator</em>, then we also can
call the <code>f</code> function.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">newCont</span> <span class="n">racc</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="n">x</span> <span class="n">racc</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>But is that right? Let&rsquo;s think what would happen. In our first recursion we get <code>1</code> from
<code>[1;2;3;4]</code> and save it in <code>x</code>. We then create a function that basically does.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">newCont</span> <span class="n">racc</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="mi">1</span> <span class="n">racc</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We pass that function as <code>cont</code> to the next iteration. In the next recursion we extract <code>2</code>
from the remaining list <code>[2;3;4]</code>, now we create a new <code>newCont</code> that basically does.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">newCont</span> <span class="n">racc</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span> <span class="mi">2</span> <span class="n">racc</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Then this new function is used as our <code>cont</code>. But this behaviour is wrong. We loop through
our list and on every step we just create a new function that will replace the old function.
The problem is, we cannot just throw the old <code>cont</code> away, we somehow have to use it. But how?</p>
<p>Let&rsquo;s look at our <code>f 2 racc</code> call. What does that function return when we call it? Or better yet,
which values do we have here exactly? Our <code>racc</code> is the <em>right-accumulator</em> that we have in the
future, in our example this will be <code>[9;16]</code>. When we call <code>f 2 racc</code> we actually call
<code>f 2 [9;16]</code>. What does our <code>f</code> function in our example? It squares <code>x</code> and add it to the <code>racc</code>.
So after we do <code>f 2 [9;16]</code> we will get <code>[4;9;16]</code> as a result.</p>
<p>But wait! Isn&rsquo;t that the <em>right-accumulator</em> that our previous <code>cont</code> needed? Yes, it is! And now
it becomes more obvious in how we need to use <code>cont</code>. We call <code>f x racc</code>, this then produces a
value that can be used to call our previous function that we passed as <code>cont</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">newCont</span> <span class="n">racc</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="k">let</span> <span class="nv">res</span> <span class="o">=</span> <span class="n">f</span> <span class="n">x</span> <span class="n">racc</span>
</span></span><span class="line"><span class="cl">    <span class="n">cont</span> <span class="n">res</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>If that sound hard to follow. Just remember <em>function composition</em> again. What we have hear is
just this idea! In function composition we call a function <code>f</code> with a value we don&rsquo;t have yet, that
will produce a value that can be passed to <code>g</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">compose</span> <span class="n">f</span> <span class="n">g</span> <span class="o">=</span> <span class="k">fun</span> <span class="n">x</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">let</span> <span class="nv">res</span> <span class="o">=</span> <span class="n">f</span> <span class="n">x</span>
</span></span><span class="line"><span class="cl">    <span class="n">g</span> <span class="n">res</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here we have the same. The only difference is that this time <code>cont</code> is a function we created
inside a function in a previous loop. Let&rsquo;s shorten the example a little bit. In function composition
we just ended with <code>let compose f g x = g (f x)</code>. We now shorten our call to:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">newCont</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">cont</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span> <span class="n">racc</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Our <code>f</code> function takes two arguments, but otherwise it is the same idea. The whole <em>loop-body</em> part
in our example now looks like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="o">|</span> <span class="n">x</span><span class="o">::</span><span class="kt">list</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">let</span> <span class="nv">newCont</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">cont</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span> <span class="n">racc</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">loop</span> <span class="n">newCont</span> <span class="kt">list</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>But we are not done yet, we still have to fill out two missing parts.</p>
<h2 id="what-do-we-do-after-we-looped-through-the-list">What do we do after we looped through the list?</h2>
<p>One remaining part is the logic we have to do once we finished our looping. Let&rsquo;s actually try to
understand what we exactly build. In every step we create a new function
that expects the <em>right-accumulator</em> with this and the current <code>x</code> we calculate the
<em>right-accumulator</em> for the previous function. In our first loop we create.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont1</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">(</span><span class="n">f</span> <span class="mi">1</span> <span class="n">racc</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In our second loop we basically do:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont2</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">cont1</span> <span class="o">(</span><span class="n">f</span> <span class="mi">2</span> <span class="n">racc</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Remember, we create a new function, but we call the previously <code>cont</code>. I used <code>cont1</code> to make
the relation more clear. Technically every new step now creates a new <code>cont</code> function that calls
the previous <code>cont</code> function. If we expand it fully we basically have.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont1</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">(</span><span class="n">f</span> <span class="mi">1</span> <span class="n">racc</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont2</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">cont1</span>    <span class="o">(</span><span class="n">f</span> <span class="mi">2</span> <span class="n">racc</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont3</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">cont2</span>    <span class="o">(</span><span class="n">f</span> <span class="mi">3</span> <span class="n">racc</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont4</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">cont3</span>    <span class="o">(</span><span class="n">f</span> <span class="mi">4</span> <span class="n">racc</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Every new function that we create contains the previous function as a closure. Actually let&rsquo;s
inline the whole functions step-by-step. First we inline <code>cont1</code> in our <code>cont2</code> function, and so on.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont2</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">(</span><span class="n">f</span> <span class="mi">1</span> <span class="o">(</span><span class="n">f</span> <span class="mi">2</span> <span class="n">racc</span><span class="o">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>then we inline <code>cont2</code> into <code>cont3</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont3</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">(</span><span class="n">f</span> <span class="mi">1</span> <span class="o">(</span><span class="n">f</span> <span class="mi">2</span> <span class="o">(</span><span class="n">f</span> <span class="mi">3</span> <span class="n">racc</span><span class="o">)))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>finally <code>cont3</code> into <code>cont4</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont4</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">(</span><span class="n">f</span> <span class="mi">1</span> <span class="o">(</span><span class="n">f</span> <span class="mi">2</span> <span class="o">(</span><span class="n">f</span> <span class="mi">3</span> <span class="o">(</span><span class="n">f</span> <span class="mi">4</span> <span class="n">racc</span><span class="o">))))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>As we can see. With every loop iteration that we go forward, we build up a function. Every new
function we create builds the <em>right-accumulator</em> that is needed for the <em>previous-step</em>.
Once we looped through our whole data-structure, we ended up with a final function. The only thing
we need to do, is to start our function by passing it the final <em>right-accumulator</em>.</p>
<p>And at this point we have the final <em>right-accumulator</em>! At the end we have to pass the
<em>right-accumulator</em> of our last element. We only have the list <code>[1;2;3;4]</code> so what is the
<em>right-accumulator</em> of the last element <code>4</code>? The <em>initial-accumulator</em> that the user passed
to <code>foldBack</code>!</p>
<p>So here is our answer. Once we reached the end of our list we have a function and we need to pass it
the <em>initial-accumulator</em>. Our <em>empty-list case</em> now looks something like that:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="n">cont</span> <span class="n">acc</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="with-what-kind-of-value-do-we-start-our-loop">With what kind of value do we start our loop?</h2>
<p>The last remaining part is how we start our loop. Or put in other words. What do we provide
as our <code>initCont</code> value? To understand this part better, let&rsquo;s assume we started our loop.
We already saw what kind of structure we build. In the end we just had</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont4</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">(</span><span class="n">f</span> <span class="mi">1</span> <span class="o">(</span><span class="n">f</span> <span class="mi">2</span> <span class="o">(</span><span class="n">f</span> <span class="mi">3</span> <span class="o">(</span><span class="n">f</span> <span class="mi">4</span> <span class="n">racc</span><span class="o">))))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Once we reach the end of our data-structure in our example we provided the empty list <code>[]</code> as the
starting right accumulator. So we basically have.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont4</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">(</span><span class="n">f</span> <span class="mi">1</span> <span class="o">(</span><span class="n">f</span> <span class="mi">2</span> <span class="o">(</span><span class="n">f</span> <span class="mi">3</span> <span class="o">(</span><span class="n">f</span> <span class="mi">4</span> <span class="bp">[]</span><span class="o">))))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>At this point, now our function starts its execution. First <code>f 4 []</code> is calculated and this will
return <code>[16]</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont4</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">(</span><span class="n">f</span> <span class="mi">1</span> <span class="o">(</span><span class="n">f</span> <span class="mi">2</span> <span class="o">(</span><span class="n">f</span> <span class="mi">3</span> <span class="o">[</span><span class="mi">16</span><span class="o">])))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now <code>f 3 [16]</code> executes and we get</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont4</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">(</span><span class="n">f</span> <span class="mi">1</span> <span class="o">(</span><span class="n">f</span> <span class="mi">2</span> <span class="o">[</span><span class="mi">9</span><span class="o">;</span><span class="mi">16</span><span class="o">]))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now it is <code>f 2 [9;16]</code> turn</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont4</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">(</span><span class="n">f</span> <span class="mi">1</span> <span class="o">[</span><span class="mi">4</span><span class="o">;</span><span class="mi">9</span><span class="o">;</span><span class="mi">16</span><span class="o">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>And finally we have</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">cont4</span> <span class="o">=</span> <span class="n">initCont</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">4</span><span class="o">;</span><span class="mi">9</span><span class="o">;</span><span class="mi">16</span><span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now <code>initCont</code> also must be a <em>function</em>. But what do we expect it to do? Well nothing!
We just expect it to return it&rsquo;s input as-is. In other words. Our <em>starting function</em> is <code>id</code>. So
we start our <code>loop</code> with <code>loop id list</code>.</p>
<h2 id="all-pieces-together">All pieces together</h2>
<p>Now let&rsquo;s put all pieces together, our final <code>foldBack</code> function now looks like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fsharp" data-lang="fsharp"><span class="line"><span class="cl"><span class="k">let</span> <span class="nv">foldBack</span> <span class="n">f</span> <span class="kt">list</span> <span class="o">(</span><span class="n">acc</span><span class="o">:</span><span class="k">&#39;</span><span class="n">State</span><span class="o">)</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">    <span class="k">let</span> <span class="nv">rec</span> <span class="n">loop</span> <span class="n">cont</span> <span class="kt">list</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">        <span class="k">match</span> <span class="kt">list</span> <span class="k">with</span>
</span></span><span class="line"><span class="cl">        <span class="o">|</span> <span class="bp">[]</span>      <span class="o">-&gt;</span> <span class="n">cont</span> <span class="n">acc</span>
</span></span><span class="line"><span class="cl">        <span class="o">|</span> <span class="n">x</span><span class="o">::</span><span class="kt">list</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="k">let</span> <span class="nv">newCont</span> <span class="n">racc</span> <span class="o">=</span> <span class="n">cont</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span> <span class="n">racc</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">loop</span> <span class="n">newCont</span> <span class="kt">list</span>
</span></span><span class="line"><span class="cl">    <span class="n">loop</span> <span class="n">id</span> <span class="kt">list</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">foldBack</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="n">acc</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">)</span> <span class="o">::</span> <span class="n">acc</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span><span class="o">;</span><span class="mi">2</span><span class="o">;</span><span class="mi">3</span><span class="o">;</span><span class="mi">4</span><span class="o">]</span> <span class="bp">[]</span>
</span></span><span class="line"><span class="cl"><span class="c1">// [1; 4; 9; 16]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">foldBack</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="n">acc</span> <span class="o">-&gt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">acc</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="o">]</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 55
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">foldBack</span> <span class="o">(</span><span class="k">fun</span> <span class="n">x</span> <span class="n">acc</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">string</span> <span class="n">x</span><span class="o">)</span> <span class="o">+</span> <span class="n">acc</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">10</span><span class="o">]</span> <span class="s">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// &#34;1234568910&#34;
</span></span></span></code></pre></td></tr></table>
</div>
</div><h1 id="conclusion">Conclusion</h1>
<p>Continuation functions in general are powerful and we can do a lot with them, solving <code>foldBack</code>
without reversing a list first is just one example. But in this case i have to admit that
understanding it is quite hard. It has nothing to do that <em>Continuation functions</em> are itself hard to
understand, the problem why it is so hard is because we cannot traverse a list backwards. Using
a continuation function is just one possible way to solve the problem. I think it is in general
worth to know and understand this solution.</p>
<p>In general I also hope that the analogy that functions just works on a <em>future value</em>
helps. At least for me this analogy was quite helpful in a lot of cases in the past.</p>
<p>One question remains. Which solution of <code>foldBack</code> should we prefer, and which is better? Well, at
first how do you measure &ldquo;better&rdquo;? Is it memory-consumption? CPU-time? Understanding code?</p>
<p>If you really care for <em>performance</em> you should benchmark. But make sure to test <em>small</em>,
<em>medium</em> and <em>big</em> input lists. In the previous <code>foldBack</code> version it doesn&rsquo;t seem that
<em>reversing</em> a list is the best option, as you have to go through a list twice and create
a new intermediate list.</p>
<p>But using this kind of <em>continuation</em> style isn&rsquo;t quite better. We basically still traverse a
list twice. We build first a continuation function, and in the end, we have to execute
it that touches every element again. A <em>continuation function</em> can result in higher
memory consumption and could be slower, <em>reversing</em> in the end can be faster and easier
to understand. But if you really care, then do benchmarks on your own.</p>
<p>But I think we should focus more on <em>readability</em>. <em>Reversing</em> is just quite easier,
so try to use the obvious solution first if you design things.</p>
<p>But at this point I also want to mention <em>mutability</em>. In functional programming in general
we don&rsquo;t care how a function works. Functions are black-boxes. We only care for the input and
the output of a function. It doesn&rsquo;t matter how it works, as long we have a <em>pure</em> function
and it expect and returns <em>immutable-data</em> everything is fine. Even if a function uses
loops, mutation or other kind of stuff. This is absolutely fine!</p>
<p>Controlled or limited <em>mutation</em> inside a function is absolutely okay. As long as that function
is <em>pure</em> and only takes and returns <em>immutable-data</em>. That doesn&rsquo;t mean everything i said
is useless.</p>
<p>It just explains the overall concept that is in general good to know and is useable in
different scenarios.</p>

        </div>
        <div class="post-footer">
            <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "davidraab" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </article>
</main>
<aside> <nav id="TableOfContents">
  <ul>
    <li><a href="#functions">Functions</a>
      <ul>
        <li><a href="#back-to-the-future">Back to the Future</a></li>
      </ul>
    </li>
    <li><a href="#rethinking-the-problem">Rethinking the problem</a></li>
    <li><a href="#functions-as-accumulator">Functions as accumulator</a>
      <ul>
        <li><a href="#what-do-we-do-for-every-element">What do we do for every element?</a></li>
        <li><a href="#what-do-we-do-after-we-looped-through-the-list">What do we do after we looped through the list?</a></li>
        <li><a href="#with-what-kind-of-value-do-we-start-our-loop">With what kind of value do we start our loop?</a></li>
        <li><a href="#all-pieces-together">All pieces together</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav> </aside>

    </body>
</html>
